---

title: "State Sync"
slug: "state_sync"
---

# State Sync
Dymension rollapp can perform a state sync from a snapshot as long as:
1. The rollapp is using an actual DA layer (Celestia/Avail, no local).

2. The snapshot has been taken less than 30 days ago.

3. The rollapp hasn't changed DA layer since the snapshot was taken.

The procedure is straightforward: Create a compressed archive of the rollapp data directory to create a snapshot, and
load it into the rollapp data to perform the state sync.

## Create a snapshot
1. Stop the rollapp.

2. Install lz4 compression tool if not already installed:
```bash
sudo apt install lz4
```

3. Create a compressed archive of the rollapp data directory:
```bash
    cd <ROLLER_CONFIG_DIR>/rollapp
    tar -cvf - data | lz4 > snapshot.tar.lz4
```
Replace `<ROLLER_CONFIG_DIR>` with the actual path to the roller config directory (default to `~/.roller`).

## Load a snapshot
4. Clear the rollapp state with
```bash
    rollapp_evm dymint unsafe-reset-all --home <ROLLER_CONFIG_DIR>/rollapp
```

5. Load the snapshot into the rollapp data directory:
```bash
    cd <ROLLER_CONFIG_DIR>/rollapp
    lz4 -c -d <SNAPSHOT_FILE_PATH> | tar -x -C .
```

6. Start the rollapp
First, make sure the rollapp is not producing blocks until it is synced by setting `aggregator=false` in the rollapp
`<ROLLER_CONFIG_DIR>/rollapp/config/dymint.toml` config file. Then start the rollapp with `roller run`. Once the
rollapp is synced, if you run a sequencer return `aggregator=true` and restart the rollapp.
